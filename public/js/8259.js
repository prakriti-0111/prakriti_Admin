"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8259],{97268:(e,i,t)=>{t.d(i,{A6:()=>o,JA:()=>u,bV:()=>d,gY:()=>n,me:()=>c,qi:()=>l});var s=t(80325),a=t(60438),r=t(45892);const n=e=>i=>{s.A.post("/superadmin/material-prices/store",e).then((e=>{i({type:a._H,payload:e.data})})).catch((e=>{}))},l=e=>i=>{s.A.get("/superadmin/material-prices/view/".concat(e)).then((e=>{console.log(e.data.data),e.data.success&&i({type:a.fI,payload:e.data.data})})).catch((e=>{}))},c=(e,i)=>t=>{s.A.post("/superadmin/material-prices/update/".concat(e),i).then((e=>{t({type:a.a$,payload:e.data})})).catch((e=>{}))},o=(e,i)=>t=>{s.A.delete("/superadmin/material-prices/delete/".concat(e),i).then((e=>{t({type:a.sN,payload:e.data})})).catch((e=>{}))},d=(e,i)=>t=>{s.A.get("/superadmin/material-prices/product-price-details/".concat(e),i).then((e=>{t({type:a.Ng,payload:e.data.data})})).catch((e=>{}))},u=e=>(e=(0,r.x0)(e,!0),s.A.get("/superadmin/material-prices".concat(e)))},68259:(e,i,t)=>{t.d(i,{A:()=>$});var s=t(63696),a=t(52821),r=t(61095),n=t(45271),l=t(41795),c=t(66107),o=t(26365),d=t(78976),u=t(63472),p=t(36122),m=t(13007),h=t(72839),_=t(49746),x=t(45892),g=t(88441),j=t(97268),A=t(45862),f=t(39167),v=t(51449),b=t(27218),C=t(50977),y=t(98993),N=t(73947),D=t(10228),F=t(45166),S=t(2598),P=t(25606),W=t(24019),M=t(89429),w=t(52805),L=t(79859),I=t(43191),V=t(17243),k=t.n(V),z=t(59385),X=t(48164),Y=t(10303),U=t(37972),q=t(62540);function G(e,i,t){return i in e?Object.defineProperty(e,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[i]=t,e}const{updateSyncErrors:J}=t(35917).default;class R extends s.Component{constructor(e){super(e),G(this,"initializeFormData",(()=>{if(this.state.formData){let e=[],i=this.state.formData;for(let t=0;t<i.purities.length;t++)e.push({id:i.purities[t].id,purity_id:i.purities[t].purity_id,price:i.purities[t].price,increase:i.purities[t].increase,mrp:i.purities[t].mrp,admin_discount:i.purities[t].admin_discount,distributor_discount:i.purities[t].distributor_discount,se_discount:i.purities[t].se_discount,retailer_max_discount:i.purities[t].retailer_max_discount,customer_discount:i.purities[t].customer_discount,admin_price:i.purities[t].admin_price,distributor_price:i.purities[t].distributor_price,se_price:i.purities[t].se_price,retailer_max_price:i.purities[t].retailer_max_price,customer_price:i.purities[t].customer_price,price_error:!1,admin_discount_error:!1,distributor_discount_error:!1,retailer_max_discount_error:!1,se_discount_error:!1,customer_discount_error:!1});this.setState({material_id:i.material_id,material_name:i.material_name,unit_name:i.unit_name,purities:i.purities,puritiesFormData:e})}else this.props.actions.categoryList({all:1})})),G(this,"initializeMaterialData",(()=>{if(this.state.material){let e="",i="",t=[],s=[];e=this.state.material.name,i=this.state.material.unit,t=this.state.material.purities;for(let e=0;e<t.length;e++)s.push({purity_id:t[e].id,price:"",increase:"",mrp:"",admin_discount:"",admin_price:"",distributor_discount:"",distributor_price:"",se_discount:"",se_price:"",retailer_max_discount:"",retailer_max_price:"",customer_discount:"",customer_price:"",price_error:!1,admin_discount_error:!1,distributor_discount_error:!1,retailer_max_discount_error:!1,se_discount_error:!1,customer_discount_error:!1});this.setState({material_id:this.state.material.id,material_name:e,unit_name:i,purities:t,puritiesFormData:s})}})),G(this,"handleCategoryChange",(e=>{let i=k().filter(this.state.categories,{id:e.target.value}),t=i.length?i[0].name:"";this.setState({category_id:e.target.value,material_id:"",material_name:"",purities:[],puritiesFormData:[],category_name:t}),this.props.actions.materialList({all:1,category_id:e.target.value})})),G(this,"handleMaterialChange",(e=>{let i=e.target.value,t=k().filter(this.state.materials,{id:i}),s="",a="",r=[],n=[];if(t){s=t[0].name,a=t[0].unit,r=t[0].purities;for(let e=0;e<r.length;e++)n.push({purity_id:r[e].id,price:"",increase:"",mrp:"",admin_discount:"",admin_price:"",distributor_discount:"",distributor_price:"",se_discount:"",se_price:"",retailer_max_discount:"",retailer_max_price:"",customer_discount:"",customer_price:"",price_error:!1,admin_discount_error:!1,distributor_discount_error:!1,retailer_max_discount_error:!1,se_discount_error:!1,customer_discount_error:!1})}this.setState({material_id:i,material_name:s,unit_name:a,purities:r,puritiesFormData:n})})),G(this,"handlePriceChange",((e,i,t)=>{let s=this.state.puritiesFormData;s[i][t]=e.target.value,this.setState({puritiesFormData:s},(()=>{this.priceCalculation()}))})),G(this,"handleSubmit",(()=>{let e=!1,i=this.state.puritiesFormData;if(0!=i.length){for(let t=0;t<i.length;t++)""==i[t].price?(i[t].price_error=!0,e=!0):i[t].price_error=!1;this.setState({puritiesFormData:i},(()=>{if(!e){let e=this.generateFormValues();console.log("values",e),this.state.isCreateFrom?this.props.actions.materialPriceStore(e):this.props.actions.materialPriceUpdate(this.state.formData.id,e)}}))}})),G(this,"generateFormValues",(()=>{let e=[],i=this.state.puritiesFormData;for(let t=0;t<i.length;t++)e.push({id:"id"in i[t]?i[t].id:0,purity_id:i[t].purity_id,price:i[t].price,admin_discount:i[t].admin_discount,distributor_discount:i[t].distributor_discount,se_discount:i[t].se_discount,retailer_max_discount:i[t].retailer_max_discount,customer_discount:i[t].customer_discount,increase:i[t].increase,mrp:i[t].mrp,admin_price:i[t].admin_price,distributor_price:i[t].distributor_price,se_price:i[t].se_price,retailer_max_price:i[t].retailer_max_price,customer_price:i[t].customer_price});return{material_id:this.state.material_id,purities:e}})),G(this,"priceCalculation",(()=>{let e=[...this.state.puritiesFormData];for(let i=0;i<e.length;i++)(0,x.Im)(e[i].price)?(e[i].mrp="",e[i].admin_price="",e[i].distributor_price="",e[i].se_price="",e[i].retailer_max_price="",e[i].customer_price=""):(e[i].mrp=(0,x.XV)((0,x.Im)(e[i].increase)||0==e[i].increase?parseFloat(e[i].price):100*parseFloat(e[i].price)/parseFloat(e[i].increase)),e[i].admin_price=(0,x.XV)((0,x.Im)(e[i].admin_discount)?parseFloat(e[i].mrp):parseFloat(e[i].mrp)-parseFloat(e[i].mrp)*parseFloat(e[i].admin_discount)/100),e[i].distributor_price=(0,x.XV)((0,x.Im)(e[i].distributor_discount)?parseFloat(e[i].mrp):parseFloat(e[i].mrp)-parseFloat(e[i].mrp)*parseFloat(e[i].distributor_discount)/100),e[i].se_price=(0,x.XV)((0,x.Im)(e[i].se_discount)?parseFloat(e[i].mrp):parseFloat(e[i].mrp)-parseFloat(e[i].mrp)*parseFloat(e[i].se_discount)/100),e[i].retailer_max_price=(0,x.XV)((0,x.Im)(e[i].retailer_max_discount)?parseFloat(e[i].mrp):parseFloat(e[i].mrp)-parseFloat(e[i].mrp)*parseFloat(e[i].retailer_max_discount)/100),e[i].customer_price=(0,x.XV)((0,x.Im)(e[i].customer_discount)?parseFloat(e[i].mrp):parseFloat(e[i].mrp)-parseFloat(e[i].mrp)*parseFloat(e[i].customer_discount)/100));this.setState({puritiesFormData:e})})),G(this,"handleCancel",(()=>{this.handleDialogClose()})),G(this,"handleCreate",(()=>{this.setState({openDialog:!0})})),G(this,"handleDialogClose",((e,i)=>{i&&"backdropClick"==i||this.setState({openDialog:!1})})),G(this,"submit",(e=>{this.props.actions.materialCreate(e)})),G(this,"handleClose",(()=>{"handleCancel"in this.props?this.props.handleCancel():this.props.navigate((0,x.zr)((0,x.mA)(this.state.auth))+"/material-prices")}));let i="formData"in this.props?this.props.formData:null,t="material"in this.props?this.props.material:null;this.state={auth:this.props.auth,formData:i,isCreateFrom:!i,categories:this.props.categories,materials:this.props.materials,material_id:"",material_name:"",category_name:"",unit_name:"",purities:[],category_id:"",puritiesFormData:[],submitting:!1,openDialog:!1,createSuccess:this.props.createSuccess,actionCalled:this.props.actionCalled,successMessage:this.props.successMessage,errorMessage:this.props.errorMessage,materialPurityList:this.props.materialPurityList,material:t}}static getDerivedStateFromProps(e,i){let t={};return e.categories!==i.categories&&(t.categories=e.categories),e.materials!==i.materials&&(t.materials=e.materials),e.formData!==i.formData&&(t.formData=e.formData),e.actionCalled!==i.actionCalled&&(t.actionCalled=e.actionCalled),e.successMessage!==i.successMessage&&(t.successMessage=e.successMessage),e.errorMessage!==i.errorMessage&&(t.errorMessage=e.errorMessage),"createSuccess"in e&&e.createSuccess!==i.createSuccess&&(t.createSuccess=e.createSuccess),"editSuccess"in e&&e.editSuccess!==i.editSuccess&&(t.editSuccess=e.editSuccess),"deleteSuccess"in e&&e.deleteSuccess!==i.deleteSuccess&&(t.deleteSuccess=e.deleteSuccess),e.materialPurityList!==i.materialPurityList&&(t.materialPurityList=e.materialPurityList),e.units!==i.units&&(t.units=e.units),e.material!==i.material&&(t.material=e.material),t}componentDidMount(){this.initializeFormData(),this.props.actions.purityList({all:1}),this.props.actions.unitList({all:1}),this.state.material&&this.initializeMaterialData()}componentDidUpdate(e){this.props.formData!=e.formData&&this.initializeFormData(),this.props.material!=e.material&&this.initializeMaterialData(),this.state.actionCalled&&this.state.createSuccess&&(this.props.enqueueSnackbar(this.state.successMessage,{variant:"success"}),this.props.dispatch({type:z.g7}),this.setState({openDialog:!1},(()=>{this.props.actions.materialList({all:1,category_id:this.state.category_id})})))}render(){return(0,q.jsxs)("div",{className:"ratn-dialog-wrapper",children:[this.state.isCreateFrom&&!this.state.material?(0,q.jsx)(r.A,{sx:{flexGrow:1,m:.5},className:"",children:(0,q.jsxs)(n.Ay,{container:!0,spacing:2,className:"tax-input loans_view price_view",children:[(0,q.jsx)(n.Ay,{item:!0,xs:6,className:"create-input",children:(0,q.jsxs)(l.A,{fullWidth:!0,children:[(0,q.jsx)(c.A,{children:"Category"}),(0,q.jsxs)(o.A,{value:this.state.category_id,label:"Category",onChange:this.handleCategoryChange,defaultValue:"",className:"input-inner",children:[(0,q.jsx)(d.A,{value:""}),this.state.categories.map(((e,i)=>(0,q.jsx)(d.A,{value:e.id,children:e.name},i)))]})]})}),(0,q.jsx)(n.Ay,{item:!0,xs:6,className:"create-input",children:(0,q.jsxs)(l.A,{fullWidth:!0,children:[(0,q.jsx)(c.A,{children:"Material"}),(0,q.jsxs)(o.A,{value:this.state.material_id,label:"Material",onChange:this.handleMaterialChange,defaultValue:"",className:"input-inner",children:[(0,q.jsx)(d.A,{value:""}),this.state.materials.map(((e,i)=>(0,q.jsx)(d.A,{value:e.id,children:e.name},i)))]})]})})]})}):null,this.state.material_id?(0,q.jsx)(q.Fragment,{children:0==this.state.purities.length?(0,q.jsx)(u.A,{variant:"filled",severity:"error",children:"No purity found."}):(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)("h3",{className:"price_list_heading",style:{marginTop:"10px"},children:this.state.material_name+" Price List / "+this.state.unit_name}),(0,q.jsxs)(S.A,{component:W.A,className:"ratn-table-wrapper table-wrapper-heading",children:[(0,q.jsxs)(y.A,{className:"price-table",style:{maxWidth:"100%",margin:"auto"},children:[(0,q.jsx)(N.A,{className:"ratn-table-header",children:(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{style:{width:"100px",fontWeight:"600"},children:"Purity"}),this.state.purities.map(((e,i)=>(0,q.jsx)(F.A,{style:{fontWeight:"600"},children:"purity_name"in e?e.purity_name:e.name},i)))]})}),(0,q.jsxs)(D.A,{className:"pricelist-body",children:[(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Price"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{className:"table-data",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},children:(0,q.jsx)(p.A,{variant:"outlined",fullWidth:!0,value:e.price,onChange:e=>this.handlePriceChange(e,i,"price"),InputProps:{startAdornment:(0,q.jsx)(m.A,{position:"start",children:"₹"})},error:e.price_error})})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Increase"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",fullWidth:!0,value:e.increase,onChange:e=>this.handlePriceChange(e,i,"increase"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"start",children:"%"})}})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{className:"pl-12",label:"MRP",disabled:!0,variant:"outlined",fullWidth:!0,value:e.mrp,error:e.price_error})})})]})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Admin Discount"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",value:e.admin_discount,onChange:e=>this.handlePriceChange(e,i,"admin_discount"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"end",className:"i-icon-right",children:"%"})},error:e.admin_discount_error})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{label:"",disabled:!0,variant:"outlined",fullWidth:!0,value:e.admin_price})})})]})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Distributor Discount"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",value:e.distributor_discount,onChange:e=>this.handlePriceChange(e,i,"distributor_discount"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"end",className:"i-icon-right",children:"%"})},error:e.distributor_discount_error})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{label:"",disabled:!0,variant:"outlined",fullWidth:!0,value:e.distributor_price})})})]})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Se Discount"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",value:e.se_discount,onChange:e=>this.handlePriceChange(e,i,"se_discount"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"end",className:"i-icon-right",children:"%"})},error:e.se_discount_error})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{label:"",disabled:!0,variant:"outlined",fullWidth:!0,value:e.se_price})})})]})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Retailer Discount"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",value:e.retailer_max_discount,onChange:e=>this.handlePriceChange(e,i,"retailer_max_discount"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"end",className:"i-icon-right",children:"%"})},error:e.retailer_max_discount_error})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{label:"",disabled:!0,variant:"outlined",fullWidth:!0,value:e.retailer_max_price})})})]})},i)))]}),(0,q.jsxs)(P.A,{children:[(0,q.jsx)(F.A,{children:"Customer Discount"}),this.state.puritiesFormData.map(((e,i)=>(0,q.jsx)(F.A,{children:(0,q.jsxs)("div",{className:"m-price-wrapper",children:[(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"left-radius",children:(0,q.jsx)(p.A,{variant:"outlined",value:e.customer_discount,onChange:e=>this.handlePriceChange(e,i,"customer_discount"),InputProps:{endAdornment:(0,q.jsx)(m.A,{position:"end",className:"i-icon-right",children:"%"})},error:e.customer_discount_error})})}),(0,q.jsx)("div",{className:"m-price-input",children:(0,q.jsx)(l.A,{fullWidth:!0,sx:{m:1},className:"right-radius",children:(0,q.jsx)(p.A,{label:"",disabled:!0,variant:"outlined",fullWidth:!0,value:e.customer_price})})})]})},i)))]})]})]}),(0,q.jsxs)(h.A,{spacing:1,direction:"row",justifyContent:"flex-end",className:"ratn-footer-buttons price-inner-button",children:[(0,q.jsx)(b.A,{className:"conf-button",variant:"contained",type:"button",onClick:this.handleSubmit,disabled:this.state.submitting,loading:this.state.submitting,children:"Submit"}),(0,q.jsx)(_.A,{variant:"outlined",className:"close-button",onClick:this.handleClose,children:"Cancel"})]})]})]})}):(0,q.jsx)(n.Ay,{container:!0,justifyContent:"center",children:(0,q.jsx)(u.A,{severity:"warning",icon:!1,className:"no-data-found"})}),(0,q.jsxs)(M.A,{className:"ratn-dialog-wrapper",open:this.state.openDialog,onClose:this.handleDialogClose,fullWidth:!0,maxWidth:"md",children:[(0,q.jsx)(I.A,{children:"Create Material"}),(0,q.jsxs)(w.A,{children:[(0,q.jsx)(L.A,{}),(0,q.jsx)(X.A,{onSubmit:this.submit,categories:this.state.categories,units:this.state.units,purities:this.state.materialPurityList,handleCancel:this.handleCancel})]})]})]})}}const $=(0,v.Gh)((0,C.A)((0,a.connect)((e=>({categories:e.superadmin.category.items,materials:e.superadmin.material.items,auth:e.auth,actionCalled:e.superadmin.material.actionCalled,createSuccess:e.superadmin.material.createSuccess,successMessage:e.superadmin.material.successMessage,errorMessage:e.superadmin.material.errorMessage,materialPurityList:e.superadmin.purity.items||[],units:e.superadmin.unit.items||[]})),(e=>({dispatch:e,actions:(0,g.bindActionCreators)({materialPriceStore:j.gY,materialPriceUpdate:j.me,categoryList:A.jv,materialList:f.Af,materialCreate:f.Y$,purityList:Y.Yj,unitList:U.Jp},e)})))(R)))}}]);