"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[7259],{7259:(e,s,t)=>{t.r(s),t.d(s,{default:()=>k});var a=t(63696),i=t(52821),r=t(49746),o=t(45271),l=t(88441),c=t(61176),n=t(66098),d=t(50977),h=t(894),p=t(27874),u=t(89429),m=t(52805),g=t(79859),S=t(43191),C=t(45),y=t(51449),D=t(45892),M=t(19404),P=t(62540);function w(e,s,t){return s in e?Object.defineProperty(e,s,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[s]=t,e}class b extends a.Component{constructor(e){super(e),w(this,"handlePagination",(e=>{this.setState({queryParams:{...this.state.queryParams,page:e}},(()=>{this.loadListData()}))})),w(this,"loadListData",(()=>{this.props.actions.roleList(this.state.queryParams)})),w(this,"handleEdit",(e=>{this.setState({editRow:e,openDialog:!0,dialogTitle:"Edit Role"})})),w(this,"handlePermissions",(e=>{this.props.navigate("permissions/"+e.id)})),w(this,"handleDelete",(e=>{this.props.actions.roleDelete(e.id)})),w(this,"handleCreate",(()=>{this.setState({openDialog:!0,dialogTitle:"Create Role",editRow:null})})),w(this,"handleDialogClose",((e,s)=>{s&&"backdropClick"==s||this.setState({openDialog:!1,editRow:null})})),w(this,"submit",(e=>{this.state.editRow?this.props.actions.roleUpdate(this.state.editRow.id,e):this.props.actions.roleCreate(e)})),w(this,"handleCancel",(()=>{this.handleDialogClose()})),this.state={...this.props,queryParams:{page:1,limit:50},openDialog:!1,isCreate:!0,editRow:null,createSuccess:!1,editSuccess:!1,deleteSuccess:!1,actionCalled:this.props.actionCalled,successMessage:this.props.successMessage,errorMessage:this.props.errorMessage},this.columns=[{name:"name",display_name:"Role Name"}]}componentDidMount(){this.loadListData()}static getDerivedStateFromProps(e,s){let t={};return e.items!==s.items&&(t.items=e.items),e.total!==s.total&&(t.total=e.total),e.actionCalled!==s.actionCalled&&(t.actionCalled=e.actionCalled),e.successMessage!==s.successMessage&&(t.successMessage=e.successMessage),e.errorMessage!==s.errorMessage&&(t.errorMessage=e.errorMessage),"createSuccess"in e&&e.createSuccess!==s.createSuccess&&(t.createSuccess=e.createSuccess),"editSuccess"in e&&e.editSuccess!==s.editSuccess&&(t.editSuccess=e.editSuccess),"deleteSuccess"in e&&e.deleteSuccess!==s.deleteSuccess&&(t.deleteSuccess=e.deleteSuccess),e.permissions!==s.permissions&&(t.permissions=e.permissions),t}componentDidUpdate(){this.state.actionCalled&&(this.state.createSuccess?(this.props.enqueueSnackbar(this.state.successMessage,{variant:"success"}),this.props.dispatch({type:M.QL,payload:!1}),this.setState({queryParams:{...this.state.queryParams,page:1},openDialog:!1,editRow:null},(()=>{this.loadListData()}))):this.state.editSuccess?(this.props.enqueueSnackbar(this.state.successMessage,{variant:"success"}),this.props.dispatch({type:M.Iu,payload:!1}),this.setState({queryParams:{...this.state.queryParams,page:1},openDialog:!1,editRow:null},(()=>{this.loadListData()}))):this.state.deleteSuccess?(this.props.enqueueSnackbar(this.state.successMessage,{variant:"success"}),this.props.dispatch({type:M.Md,payload:!1}),this.handlePagination(1)):null!=this.state.errorMessage&&this.props.enqueueSnackbar(this.state.errorMessage,{variant:"error"}),this.props.dispatch({type:M.Yp}))}render(){return(0,P.jsxs)(n.A,{title:"Roles",secondary:(0,D._m)(this.state.permissions,"roles","add")?(0,P.jsx)(r.A,{variant:"contained",onClick:this.handleCreate,children:"Add"}):null,children:[(0,P.jsx)(o.Ay,{container:!0,spacing:c.iL,children:(0,P.jsx)(p.A,{columns:this.columns,rows:this.state.items,page:this.state.queryParams.page,limit:this.state.queryParams.limit,total:this.state.total,handlePagination:this.handlePagination,actions:[{label:"Edit",onClick:this.handleEdit,color:"primary",show:(0,D._m)(this.state.permissions,"roles","edit")},{label:"Delete",onClick:this.handleDelete,isDelete:!0,color:"error",show:(0,D._m)(this.state.permissions,"roles","delete"),conditions:[{key:"can_delete",value:!0}]},{label:"Permissions",onClick:this.handlePermissions,color:"primary",show:(0,D._m)(this.state.permissions,"roles","edit")}]})}),(0,P.jsxs)(u.A,{className:"ratn-dialog-wrapper",open:this.state.openDialog,onClose:this.handleDialogClose,fullWidth:!0,maxWidth:"sm",children:[(0,P.jsx)(S.A,{children:this.state.dialogTitle}),(0,P.jsxs)(m.A,{children:[(0,P.jsx)(g.A,{}),(0,P.jsx)(C.A,{formData:this.state.editRow,handleCancel:this.handleCancel})]})]})]})}}const k=(0,y.Gh)((0,d.A)((0,i.connect)((e=>({items:e.superadmin.role.items,total:e.superadmin.role.total,actionCalled:e.superadmin.role.actionCalled,createSuccess:e.superadmin.role.createSuccess,editSuccess:e.superadmin.role.editSuccess,deleteSuccess:e.superadmin.role.deleteSuccess,successMessage:e.superadmin.role.successMessage,errorMessage:e.superadmin.role.errorMessage,permissions:e.employee.permissions.permissions})),(e=>({dispatch:e,actions:(0,l.bindActionCreators)({roleList:h.r9,roleCreate:h.D9,roleUpdate:h.Oy,roleDelete:h.I8},e)})))(b)))}}]);